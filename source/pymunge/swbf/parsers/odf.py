from pathlib import Path
import re

from parxel.nodes import Node, LexicalNode
from parxel.token import TK, Token

from app.registry import FileRegistry, Dependency
from swbf.parsers.format import Format
from util.enum import Enum
from util.logging import get_logger


logger = get_logger(__name__)


class Comment(LexicalNode):
    def __init__(self, tokens: list[Token], parent: Node = None):
        LexicalNode.__init__(self, tokens, parent)

        self.text: str = self.raw().strip()


class Key(LexicalNode):
    def __init__(self, tokens: list[Token], parent: Node = None):
        LexicalNode.__init__(self, tokens, parent)

        self.name: str = self.raw().strip()

        if self.name not in Odf.Key:
            logger.warning(f'Key name "{self.name}" is not known.')


class Value(LexicalNode):
    def __init__(self, tokens: list[Token], parent: Node = None):
        LexicalNode.__init__(self, tokens, parent)

        self.value: str = self.raw().strip()


class Reference(Value, Dependency):
    RE_FILE = re.compile(r'"\w+\.\w+"')
    def __init__(self, tokens: list[Token], parent: Node = None):
        Value.__init__(self, tokens, parent)

        filepath = Path(self.raw())
        Dependency.__init__(self, filepath.resolve())


class Section(LexicalNode):
    def __init__(self, tokens: list[Token], parent: Node = None):
        LexicalNode.__init__(self, tokens, parent)

        self.name: str = self.raw().strip()

        if self.name not in Odf.Section:
            logger.warning(f'Section name "{self.name}" is not known.')


class Odf(Format):
    class Section(Enum):
       ExplosionClass = 'ExplosionClass'
       GameObjectClass = 'GameObjectClass'
       InputSystem = 'InputSystem'
       InstanceProperties = 'InstanceProperties'
       OrdnanceClass = 'OrdnanceClass'
       Properties = 'Properties'
       WeaponClass = 'WeaponClass'

    class Key(Enum):
       Abandon = 'abandon'
       Acceleration = 'Acceleration'
       Acceleraton = 'Acceleraton'
       AcquiredTargetSound = 'AcquiredTargetSound'
       ActiveRotateNode = 'ActiveRotateNode'
       ActiveSpinNode = 'ActiveSpinNode'
       AddHealth = 'AddHealth'
       AddonAttachJoint = 'AddonAttachJoint'
       AddShield = 'AddShield'
       AddShieldOff = 'AddShieldOff'
       AddSpringBody = 'AddSpringBody'
       AfterburnerOffSound = 'AfterburnerOffSound'
       AfterburnerOnSound = 'AfterburnerOnSound'
       AfterburnerSpeed = 'AfterburnerSpeed'
       AIDriverGetInSound = 'AIDriverGetInSound'
       AIDriverGetOutSound = 'AIDriverGetOutSound'
       AIFieldFollowSound = 'AIFieldFollowSound'
       AIFieldHoldSound = 'AIFieldHoldSound'
       AIFieldMoveOutSound = 'AIFieldMoveOutSound'
       AIGunnerAllClearSound = 'AIGunnerAllClearSound'
       AIGunnerGetInSound = 'AIGunnerGetInSound'
       AIGunnerGetOutSound = 'AIGunnerGetOutSound'
       AIGunnerSteadySound = 'AIGunnerSteadySound'
       AimAzimuth = 'AimAzimuth'
       AimDistance = 'AimDistance'
       AimElevation = 'AimElevation'
       AimerNodeName = 'AimerNodeName'
       AimerPitchLimits = 'AimerPitchLimits'
       AimerPitchLimts = 'AimerPitchLimts'
       AimerYawLimits = 'AimerYawLimits'
       AimerYawLimts = 'AimerYawLimts'
       AimFactorMove = 'AimFactorMove'
       AimFactorPostureCrouch = 'AimFactorPostureCrouch'
       AimFactorPostureProne = 'AimFactorPostureProne'
       AimFactorPostureSpecial = 'AimFactorPostureSpecial'
       AimFactorPostureStand = 'AimFactorPostureStand'
       AimFactorStrafe = 'AimFactorStrafe'
       AimTension = 'AimTension'
       AimValue = 'AimValue'
       AIPassengerGetInSound = 'AIPassengerGetInSound'
       AIPassengerGetOutSound = 'AIPassengerGetOutSound'
       AIPassengerMoveOutSound = 'AIPassengerMoveOutSound'
       AIPassengerStopSound = 'AIPassengerStopSound'
       AIResponseNosirSound = 'AIResponseNosirSound'
       AIResponseYessirSound = 'AIResponseYessirSound'
       AISCDriverGetInSound = 'AISCDriverGetInSound'
       AISCDriverGetOutSound = 'AISCDriverGetOutSound'
       AISCFieldFollowSound = 'AISCFieldFollowSound'
       AISCFieldHoldSound = 'AISCFieldHoldSound'
       AISCFieldMoveOutSound = 'AISCFieldMoveOutSound'
       AISCGunnerAllClearSound = 'AISCGunnerAllClearSound'
       AISCGunnerGetInSound = 'AISCGunnerGetInSound'
       AISCGunnerGetOutSound = 'AISCGunnerGetOutSound'
       AISCGunnerSteadySound = 'AISCGunnerSteadySound'
       AISCPassengerGetInSound = 'AISCPassengerGetInSound'
       AISCPassengerGetOutSound = 'AISCPassengerGetOutSound'
       AISCPassengerMoveOutSound = 'AISCPassengerMoveOutSound'
       AISCPassengerStopSound = 'AISCPassengerStopSound'
       AISCResponseNosirSound = 'AISCResponseNosirSound'
       AISCResponseYessirSound = 'AISCResponseYessirSound'
       AISizeType = 'AISizeType'
       AlignVertical = 'AlignVertical'
       AllMusic = 'AllMusic'
       AllyCount = 'AllyCount'
       AllyPath = 'AllyPath'
       Alpha = 'Alpha'
       Ambient2Sound = 'Ambient2Sound'
       AmbientSound = 'AmbientSound'
       AnimalHealth = 'AnimalHealth'
       AnimalScale = 'AnimalScale'
       AnimatedAddon = 'AnimatedAddon'
       AnimatedPilotPosition = 'AnimatedPilotPosition'
       Animation = 'Animation'
       AnimationAddon = 'AnimationAddon'
       AnimationBank = 'AnimationBank'
       AnimationExtraFile = 'AnimationExtraFile'
       AnimationLowRes = 'AnimationLowRes'
       AnimationName = 'AnimationName'
       AnimationTrigger = 'AnimationTrigger'
       ApproachingTargetSound = 'ApproachingTargetSound'
       ArmName = 'ArmName'
       ArmorScale = 'ArmorScale'
       AttachDynamic = 'AttachDynamic'
       AttachedMesh = 'AttachedMesh'
       AttachEffect = 'AttachEffect'
       AttachOdf = 'AttachOdf'
       AttachToHardpoint = 'AttachToHardpoint'
       AttachToHardPoint = 'AttachToHardPoint'
       AttachTrigger = 'AttachTrigger'
       AutoAimSize = 'AutoAimSize'
       AutoAimYLimits = 'AutoAimYLimits'
       AutoFire = 'AutoFire'
       AvailableForAnyTeam = 'AvailableForAnyTeam'
       BallAcceleration = 'BallAcceleration'
       BallCollision = 'BallCollision'
       BallLowResModel = 'BallLowResModel'
       BallMaxLean = 'BallMaxLean'
       BallMinMoveSpeed = 'BallMinMoveSpeed'
       BallMoveSpeed = 'BallMoveSpeed'
       BallMoveThreshold = 'BallMoveThreshold'
       BallRadius = 'BallRadius'
       BallRollingFriction = 'BallRollingFriction'
       BallSlippage = 'BallSlippage'
       BallTurnSpeed = 'BallTurnSpeed'
       BallWaterDamageHeight = 'BallWaterDamageHeight'
       BankAngle = 'BankAngle'
       BankFilter = 'BankFilter'
       BarrelLength = 'BarrelLength'
       BarrelNodeName = 'BarrelNodeName'
       BarrelRecoil = 'BarrelRecoil'
       BeamIntensity = 'BeamIntensity'
       BlurEffect = 'BlurEffect'
       BlurLength = 'BlurLength'
       BlurStart = 'BlurStart'
       BodyOmegaXSpringFactor = 'BodyOmegaXSpringFactor'
       BodySpringLength = 'BodySpringLength'
       BoostSound = 'BoostSound'
       BoxSize = 'BoxSize'
       BuildAnimation = 'BuildAnimation'
       BuildingAmmo = 'BuildingAmmo'
       BuildingBuild = 'BuildingBuild'
       BuildingCollision = 'BuildingCollision'
       BuildingCollisionPrim = 'BuildingCollisionPrim'
       BuildingHealth = 'BuildingHealth'
       BuildingRebuild = 'BuildingRebuild'
       BuildingScale = 'BuildingScale'
       BuildingSection = 'BUILDINGSECTION'
       BuildModelOdf = 'BuildModelOdf'
       BuildPoint = 'BuildPoint'
       BuiltCollision = 'BuiltCollision'
       BuiltSound = 'BuiltSound'
       CableLength = 'CableLength'
       CameraDistance = 'CameraDistance'
       CameraHeight = 'CameraHeight'
       CameraSection = 'CAMERASECTION'
       CanDeflect = 'CanDeflect'
       CapturedSound = 'CapturedSound'
       CapturePosts = 'CapturePosts'
       CaptureRegion = 'CaptureRegion'
       CaptureTime = 'CaptureTime'
       CargoNodeName = 'CargoNodeName'
       ChangeModeSound = 'ChangeModeSound'
       ChargeDelayHeavy = 'ChargeDelayHeavy'
       ChargeDelayLight = 'ChargeDelayLight'
       ChargeRateHeavy = 'ChargeRateHeavy'
       ChargeRateLight = 'ChargeRateLight'
       ChargeSound = 'ChargeSound'
       ChargeSoundPitch = 'ChargeSoundPitch'
       ChargeUpEffect = 'ChargeUpEffect'
       ChunkAngularDamping = 'ChunkAngularDamping'
       ChunkBounciness = 'ChunkBounciness'
       ChunkDeathSpeed = 'ChunkDeathSpeed'
       ChunkFrequency = 'ChunkFrequency'
       ChunkGeometryName = 'ChunkGeometryName'
       ChunkLinearDamping = 'ChunkLinearDamping'
       ChunkNodeName = 'ChunkNodeName'
       ChunkOmega = 'ChunkOmega'
       ChunkPhysics = 'ChunkPhysics'
       ChunkSection = 'CHUNKSECTION'
       ChunkSimpleFriction = 'ChunkSimpleFriction'
       ChunkSmokeEffect = 'ChunkSmokeEffect'
       ChunkSmokeNodeName = 'ChunkSmokeNodeName'
       ChunkSpeed = 'ChunkSpeed'
       ChunkStartDistance = 'ChunkStartDistance'
       ChunkStickiness = 'ChunkStickiness'
       ChunkTerrainCollisions = 'ChunkTerrainCollisions'
       ChunkTerrainEffect = 'ChunkTerrainEffect'
       ChunkTrailEffect = 'ChunkTrailEffect'
       ChunkUpFactor = 'ChunkUpFactor'
       ChunkVelocityFactor = 'ChunkVelocityFactor'
       CisMusic = 'CisMusic'
       CISMusic = 'CISMusic'
       ClankLeftRunSound = 'ClankLeftRunSound'
       ClankLeftWalkSound = 'ClankLeftWalkSound'
       ClankRightRunSound = 'ClankRightRunSound'
       ClankRightWalkSound = 'ClankRightWalkSound'
       ClassAllATK = 'ClassAllATK'
       ClassAllDEF = 'ClassAllDEF'
       ClassCISATK = 'ClassCISATK'
       ClassCISDEF = 'ClassCISDEF'
       ClassHisATK = 'ClassHisATK'
       ClassHisDEF = 'ClassHisDEF'
       ClassImpATK = 'ClassImpATK'
       ClassImpDEF = 'ClassImpDEF'
       ClassLabel_ = 'classLabel' # TODO
       ClassLabel = 'ClassLabel'
       ClassLocATK = 'ClassLocATK'
       ClassLocDEF = 'ClassLocDEF'
       ClassRepATK = 'ClassRepATK'
       ClassRepDEF = 'ClassRepDEF'
       CloseSound = 'CloseSound'
       ClothingRustleSound = 'ClothingRustleSound'
       cmd_lclick = 'cmd_lclick'
       cmd_lhold = 'cmd_lhold'
       cmd_rclick = 'cmd_rclick'
       cmd_rhold = 'cmd_rhold'
       CockedAngle = 'CockedAngle'
       CockpitChatterStream = 'CockpitChatterStream'
       CockpitTension = 'CockpitTension'
       CodeInitialWidth = 'CodeInitialWidth'
       Collision_ = 'Collision' # TODO
       Collision = 'COLLISION'
       CollisionInflict = 'CollisionInflict'
       CollisionLowResRootScale = 'CollisionLowResRootScale'
       CollisionName = 'collisionName'
       CollisionOtherSound = 'CollisionOtherSound'
       CollisionRootScale = 'CollisionRootScale'
       CollisionScale = 'CollisionScale'
       CollisionSound = 'CollisionSound'
       CollisionThreshold = 'CollisionThreshold'
       Color = 'Color'
       ConeAngle = 'ConeAngle'
       ConeFadeFactor = 'ConeFadeFactor'
       ConeFadeLength = 'ConeFadeLength'
       ConeHeight = 'ConeHeight'
       ConeInitialWidth = 'ConeInitialWidth'
       ConeLength = 'ConeLength'
       ConeWidth = 'ConeWidth'
       Controllable = 'Controllable'
       ControlRegion = 'ControlRegion'
       ControlZone = 'ControlZone'
       CrouchMoveSpread = 'CrouchMoveSpread'
       CrouchStillSpread = 'CrouchStillSpread'
       Damage = 'Damage'
       DamageAttachPoint = 'DamageAttachPoint'
       DamageDeduction = 'DamageDeduction'
       DamageEffect = 'DamageEffect'
       DamageEffectScale = 'DamageEffectScale'
       DamageInheritVelocity = 'DamageInheritVelocity'
       DamageRadius = 'DamageRadius'
       DamageRadiusInner = 'DamageRadiusInner'
       DamageRadiusOuter = 'DamageRadiusOuter'
       DamageStartPercent = 'DamageStartPercent'
       DamageStopPercent = 'DamageStopPercent'
       DamageThreshold = 'DamageThreshold'
       DarknessMax = 'DarknessMax'
       DarknessMin = 'DarknessMin'
       DeathAnimation = 'DeathAnimation'
       DeathAnimationExplosion = 'DeathAnimationExplosion'
       DeathAnimationExplosionTime = 'DeathAnimationExplosionTime'
       DeathDustDelay = 'DeathDustDelay'
       DeathDustEffect = 'DeathDustEffect'
       DeathDustOffset = 'DeathDustOffset'
       DeathEffect = 'DeathEffect'
       DeathEffectOffset = 'DeathEffectOffset'
       DeathOnCollision = 'DeathOnCollision'
       DeathShakeDelay = 'DeathShakeDelay'
       DeathShakeDuration = 'DeathShakeDuration'
       DeathShakeForce = 'DeathShakeForce'
       DeathShakeRadius = 'DeathShakeRadius'
       DeathSound = 'DeathSound'
       DeathTime = 'DeathTime'
       Decal = 'Decal'
       DecayTime = 'DecayTime'
       Deceleration = 'Deceleration'
       DeflectSound = 'DeflectSound'
       DenyFlyerLand = 'DenyFlyerLand'
       Deploy = 'deploy'
       DestroyedGeometryName = 'DestroyedGeometryName'
       DetatchSound = 'DetatchSound'
       DisableForCloneWars = 'DisableForCloneWars'
       DisableTime = 'DisableTime'
       Discharge = 'Discharge'
       DischargeSound = 'DischargeSound'
       DisguiseOwnerModel = 'DisguiseOwnerModel'
       DisputeSound = 'DisputeSound'
       DroidHealth = 'DroidHealth'
       DroidScale = 'DroidScale'
       DropItemClass = 'DropItemClass'
       DropItemProbability = 'DropItemProbability'
       DropShadowSize = 'DropShadowSize'
       Effect = 'Effect'
       EffectRegion = 'EffectRegion'
       Eject = 'eject'
       Emitter = 'Emitter'
       EnableDeathExplosions = 'EnableDeathExplosions'
       EnemyColor = 'EnemyColor'
       EngineSound = 'EngineSound'
       ExpireEffect = 'ExpireEffect'
       ExpireTimeEnemy = 'ExpireTimeEnemy'
       ExpireTimeField = 'ExpireTimeField'
       Explosion = 'Explosion'
       ExplosionClass = 'ExplosionClass'
       ExplosionCritical = 'ExplosionCritical'
       ExplosionDeath = 'ExplosionDeath'
       ExplosionDestruct = 'ExplosionDestruct'
       ExplosionExpire = 'ExplosionExpire'
       ExplosionImpact = 'ExplosionImpact'
       ExplosionName = 'ExplosionName'
       ExplosionOffset = 'ExplosionOffset'
       ExplosionTrigger = 'ExplosionTrigger'
       ExtremeRange = 'ExtremeRange'
       EyePointCenter = 'EyePointCenter'
       EyePointOffset = 'EyePointOffset'
       FadeOutTime = 'FadeOutTime'
       FinalExplosion = 'FinalExplosion'
       FinalExplosionOffset = 'FinalExplosionOffset'
       FinAnimation = 'FinAnimation'
       FireAnim = 'FireAnim'
       FireEmptySound = 'FireEmptySound'
       FireLoopSound = 'FireLoopSound'
       FireNodeName = 'FireNodeName'
       FireOutsideLimits = 'FireOutsideLimits'
       FirePoint = 'FirePoint'
       FirePointName = 'FirePointName'
       FireSound = 'FireSound'
       FireSoundStop = 'FireSoundStop'
       FireStateTime = 'FireStateTime'
       FireVelocity = 'FireVelocity'
       FirstPerson = 'FirstPerson'
       FirstPersonFOV = 'FirstPersonFOV'
       FirstRadius = 'FirstRadius'
       FlareAngle = 'FlareAngle'
       FlareIntensity = 'FlareIntensity'
       FlashColor = 'FlashColor'
       FlashLength = 'FlashLength'
       FlashLightColor = 'FlashLightColor'
       FlashLightDuration = 'FlashLightDuration'
       FlashLightRadius = 'FlashLightRadius'
       FlatCount = 'FlatCount'
       FlatFaceFactor = 'FlatFaceFactor'
       FlatGrassSwing = 'FlatGrassSwing'
       FlatHeight = 'FlatHeight'
       FlatSizeMultiplier = 'FlatSizeMultiplier'
       FleeSound = 'FleeSound'
       FlickerPeriod = 'FlickerPeriod'
       FlickerType = 'FlickerType'
       FlyerBan = 'FlyerBan'
       FlyerSection = 'FLYERSECTION'
       FoleyFXClass = 'FoleyFXClass'
       FoleyFXGroup = 'FoleyFXGroup'
       FootBoneLeft = 'FootBoneLeft'
       FootBoneRight = 'FootBoneRight'
       Footstep0Sound = 'Footstep0Sound'
       Footstep1Sound = 'Footstep1Sound'
       Footstep2Sound = 'Footstep2Sound'
       FootstepSound0 = 'FootstepSound0'
       FootstepSound1 = 'FootstepSound1'
       FootStepSound1 = 'FootStepSound1'
       FootstepSound2 = 'FootstepSound2'
       FootStepSound2 = 'FootStepSound2'
       FootstepSound3 = 'FootstepSound3'
       FootstepSound4 = 'FootstepSound4'
       FootstepSound5 = 'FootstepSound5'
       FootWaterSplashEffect = 'FootWaterSplashEffect'
       ForceFireAnimation = 'ForceFireAnimation'
       ForceMode = 'ForceMode'
       ForwardSpeed = 'ForwardSpeed'
       ForwardTurnSpeed = 'ForwardTurnSpeed'
       Friction = 'Friction'
       FriendlyColor = 'FriendlyColor'
       FrontalTarget = 'frontal_target'
       FXName = 'FXName'
       GeometryAddon = 'GeometryAddon'
       GeometryColorMax = 'GeometryColorMax'
       GeometryColorMin = 'GeometryColorMin'
       GeometryLowRes = 'GeometryLowRes'
       GeometryName_ = 'geometryName' # TODO
       GeometryName = 'GeometryName'
       GeometryScale_ = 'geometryScale' # TODO
       GeometryScale = 'GeometryScale'
       GlowLength = 'GlowLength'
       Gravity = 'Gravity'
       GravityScale = 'GravityScale'
       GroundedHeight = 'GroundedHeight'
       GroundedSound = 'GroundedSound'
       HealthScale = 'HealthScale'
       HealthSScale = 'HealthSScale'
       HealthStatusTexture = 'HealthStatusTexture'
       HealthTexture = 'HealthTexture'
       Healthtype = 'Healthtype'
       HealthType = 'HealthType'
       HeardEnemySound = 'HeardEnemySound'
       HeatPerShot = 'HeatPerShot'
       HeatRecoverRate = 'HeatRecoverRate'
       HeatThreshold = 'HeatThreshold'
       Height = 'Height'
       HeightScale = 'HeightScale'
       HideHealthBar = 'HideHealthBar'
       HideOnFire = 'HideOnFire'
       HideUnbuiltModel = 'HideUnbuiltModel'
       HidingSound = 'HidingSound'
       HierarchyLevel = 'HierarchyLevel'
       HighResGeometry = 'HighResGeometry'
       HitLocation = 'HitLocation'
       HitSound = 'HitSound'
       HoloBeamIntensity = 'HoloBeamIntensity'
       HoloFadeInTime = 'HoloFadeInTime'
       HoloFlareIntensity = 'HoloFlareIntensity'
       HoloFlickerAlphaMax = 'HoloFlickerAlphaMax'
       HoloFlickerAlphaMin = 'HoloFlickerAlphaMin'
       HoloFlickerRate = 'HoloFlickerRate'
       HoloHeight = 'HoloHeight'
       HoloImageGeometry = 'HoloImageGeometry'
       HoloImageIntensity = 'HoloImageIntensity'
       HoloLightIntensity = 'HoloLightIntensity'
       HoloLightRadius = 'HoloLightRadius'
       HoloOdf = 'HoloOdf'
       HoloPopRate = 'HoloPopRate'
       HoloRotateRate = 'HoloRotateRate'
       HoloSize = 'HoloSize'
       HoloTurnOnTime = 'HoloTurnOnTime'
       HoloType = 'HoloType'
       HoloVisibleDistance = 'HoloVisibleDistance'
       HorizontalSpread = 'HorizontalSpread'
       HoverBan = 'HoverBan'
       HugeBan = 'HugeBan'
       HurtSound = 'HurtSound'
       HydraulicLowerHeight = 'HydraulicLowerHeight'
       HydraulicLowerSound = 'HydraulicLowerSound'
       HydraulicSound = 'HydraulicSound'
       HydraulicSoundHeight = 'HydraulicSoundHeight'
       IconStatusTexture = 'IconStatusTexture'
       IconTexture = 'IconTexture'
       IdleAnimation = 'IdleAnimation'
       IdleDelay = 'IdleDelay'
       IdleRotateSpeed = 'IdleRotateSpeed'
       IdleWaitTime = 'IdleWaitTime'
       IdleWobbleFactor = 'IdleWobbleFactor'
       IdleWobbleLeftFoot = 'IdleWobbleLeftFoot'
       IdleWobbleNode = 'IdleWobbleNode'
       IdleWobbleRightFoot = 'IdleWobbleRightFoot'
       IgnorableCollsion = 'IgnorableCollsion'
       ImpactEffect = 'ImpactEffect'
       ImpactEffectRigid = 'ImpactEffectRigid'
       ImpactEffectShield = 'ImpactEffectShield'
       ImpactEffectSoft = 'ImpactEffectSoft'
       ImpactEffectStatic = 'ImpactEffectStatic'
       ImpactEffectTerrain = 'ImpactEffectTerrain'
       ImpactEffectWater = 'ImpactEffectWater'
       ImpMusic = 'ImpMusic'
       InitialCableLength = 'InitialCableLength'
       InitialSalvoDelay = 'InitialSalvoDelay'
       InputSystem = 'InputSystem'
       InstanceProperties = 'InstanceProperties'
       IsPilotExposed = 'IsPilotExposed'
       JetDuration = 'JetDuration'
       JetEffect = 'JetEffect'
       JetFuelCost = 'JetFuelCost'
       JetFuelInitialCost = 'JetFuelInitialCost'
       JetFuelMinBorder = 'JetFuelMinBorder'
       JetFuelRechargeRate = 'JetFuelRechargeRate'
       JetJump = 'JetJump'
       JetPush = 'JetPush'
       JetType = 'JetType'
       Jump = 'jump'
       JumpDeduction = 'JumpDeduction'
       JumpSound = 'JumpSound'
       KickBuildup = 'KickBuildup'
       KickSpread = 'KickSpread'
       KickStrength = 'KickStrength'
       KillRegion = 'KillRegion'
       KillSoldierSound = 'KillSoldierSound'
       Label = 'Label'
       LandedHeight = 'LandedHeight'
       LandingSpeed = 'LandingSpeed'
       LandingTime = 'LandingTime'
       LandSound = 'LandSound'
       LaserGlowColor = 'LaserGlowColor'
       LaserLength = 'LaserLength'
       LaserTexture = 'LaserTexture'
       LaserWidth = 'LaserWidth'
       LeftFootstepSound = 'LeftFootstepSound'
       LegBoneLeft = 'LegBoneLeft'
       LegBoneRight = 'LegBoneRight'
       LegBoneTopLeft = 'LegBoneTopLeft'
       LegBoneTopRight = 'LegBoneTopRight'
       LegPairCount = 'LegPairCount'
       LegRayHitLength = 'LegRayHitLength'
       LevelDamp = 'LevelDamp'
       LevelFilter = 'LevelFilter'
       LevelSpring = 'LevelSpring'
       Lifespan = 'Lifespan'
       LifeSpan = 'LifeSpan'
       LiftDamp = 'LiftDamp'
       LiftSpring = 'LiftSpring'
       LightColor = 'LightColor'
       LightDuration = 'LightDuration'
       Lighting = 'Lighting'
       LightningEffect = 'LightningEffect'
       LightRadius = 'LightRadius'
       Lights = 'lights'
       LocalsColor = 'LocalsColor'
       LockedOnSound = 'LockedOnSound'
       LockedSound = 'LockedSound'
       LockOffAngle = 'LockOffAngle'
       LockOnAngle_ = 'lockOnAngle' # TODO
       LockOnAngle = 'LockOnAngle'
       LockOnRange = 'LockOnRange'
       LockOnTime = 'LockOnTime'
       LockTime = 'LockTime'
       LostSound = 'LostSound'
       LowHealthSound = 'LowHealthSound'
       LowHealthThreshold = 'LowHealthThreshold'
       LowResModel = 'LowResModel'
       MapScale = 'MapScale'
       MapTexture = 'MapTexture'
       MaxAlpha = 'MaxAlpha'
       MaxBallAngle = 'MaxBallAngle'
       MaxChargeStrengthHeavy = 'MaxChargeStrengthHeavy'
       MaxChargeStrengthLight = 'MaxChargeStrengthLight'
       MaxDamage = 'MaxDamage'
       MaxDelayHeavy = 'MaxDelayHeavy'
       MaxDelayLight = 'MaxDelayLight'
       MaxDistance = 'MaxDistance'
       MaxFallingLeaves = 'MaxFallingLeaves'
       MaxHealth = 'MaxHealth'
       MaxHeavy = 'MaxHeavy'
       MaxHeavyDecay = 'MaxHeavyDecay'
       MaxInterval = 'MaxInterval'
       MaxItems = 'MaxItems'
       MaxJumpDistance = 'MaxJumpDistance'
       MaxLifetime = 'MaxLifetime'
       MaxLifeTime = 'MaxLifeTime'
       MaxLight = 'MaxLight'
       MaxLightDecay = 'MaxLightDecay'
       MaxPitchSpeed = 'MaxPitchSpeed'
       MaxPos = 'MaxPos'
       MaxPressedTime = 'MaxPressedTime'
       MaxPush = 'MaxPush'
       MaxRange = 'MaxRange'
       MaxScatterBirds = 'MaxScatterBirds'
       MaxShakeAmt = 'MaxShakeAmt'
       MaxShakeLen = 'MaxShakeLen'
       MaxShield = 'MaxShield'
       MaxSize = 'MaxSize'
       MaxSkew = 'MaxSkew'
       MaxSpeed = 'MaxSpeed'
       MaxSpread = 'MaxSpread'
       MaxStrafeSpeed = 'MaxStrafeSpeed'
       MaxStrength = 'MaxStrength'
       MaxTargets = 'MaxTargets'
       MaxTerrainAngle = 'MaxTerrainAngle'
       MaxTimeLeftHeavy = 'MaxTimeLeftHeavy'
       MaxTimeLeftLight = 'MaxTimeLeftLight'
       MaxTurnSpeed = 'MaxTurnSpeed'
       MaxVel = 'MaxVel'
       MaxYawSpeed = 'MaxYawSpeed'
       MediumBan = 'MediumBan'
       MidSpeed = 'MidSpeed'
       MinAlpha = 'MinAlpha'
       MinDamage = 'MinDamage'
       MinDelayHeavy = 'MinDelayHeavy'
       MinDelayLight = 'MinDelayLight'
       MinDistance = 'MinDistance'
       MinEnemyRadius = 'MinEnemyRadius'
       MinHeavy = 'MinHeavy'
       MinHeavyDecay = 'MinHeavyDecay'
       MinInterval = 'MinInterval'
       MinLifetime = 'MinLifetime'
       MinLifeTime = 'MinLifeTime'
       MinLight = 'MinLight'
       MinLightDecay = 'MinLightDecay'
       MinPos = 'MinPos'
       MinPush = 'MinPush'
       MinRange = 'MinRange'
       MinShakeAmt = 'MinShakeAmt'
       MinShakeLen = 'MinShakeLen'
       MinSize = 'MinSize'
       MinSpeed = 'MinSpeed'
       MinSpread = 'MinSpread'
       MinStrength = 'MinStrength'
       MinTimeLeftHeavy = 'MinTimeLeftHeavy'
       MinTimeLeftLight = 'MinTimeLeftLight'
       MinVel = 'MinVel'
       ModeTexture = 'ModeTexture'
       ModeTextureColor = 'ModeTextureColor'
       MountPos = 'MountPos'
       MoveTension = 'MoveTension'
       MoveTensionX = 'MoveTensionX'
       MoveTensionY = 'MoveTensionY'
       MoveTensionZ = 'MoveTensionZ'
       MovingTurnOnly = 'MovingTurnOnly'
       Music = 'Music'
       MusicDelay = 'MusicDelay'
       MusicSpeed = 'MusicSpeed'
       MuzzleFlash = 'MuzzleFlash'
       MuzzleFlashEffect = 'MuzzleFlashEffect'
       NeutralColor = 'NeutralColor'
       NeutralizeTime = 'NeutralizeTime'
       NextAimer = 'NextAimer'
       NextBarrel = 'NextBarrel'
       NextCharge_ = 'NextCharge' # TODO
       NextCharge = 'NEXTCHARGE'
       NextDropItem = 'NextDropItem'
       NoCombatInterrupt = 'NoCombatInterrupt'
       NoDeathExplosions = 'NoDeathExplosions'
       NoEnterVehicles = 'NoEnterVehicles'
       NoRandomSpring = 'NoRandomSpring'
       NormalDirection = 'NormalDirection'
       NumChunks = 'NumChunks'
       NumDustObjectsInEffects = 'NumDustObjectsInEffects'
       NumParticles = 'NumParticles'
       NumParts = 'NumParts'
       NumRays = 'NumRays'
       NumVisible = 'NumVisible'
       Odf = 'Odf'
       Offset = 'Offset'
       OmegaXDamp = 'OmegaXDamp'
       OmegaXSpring = 'OmegaXSpring'
       OmegaZDamp = 'OmegaZDamp'
       OmegaZSpring = 'OmegaZSpring'
       OmniLightRadius = 'OmniLightRadius'
       OmniRadius = 'OmniRadius'
       OpenSound = 'OpenSound'
       OptimalRange = 'OptimalRange'
       OrdnanceClass = 'OrdnanceClass'
       Ordnancecollision = 'Ordnancecollision'
       OrdnanceCollision = 'OrdnanceCollision'
       OrdnanceCollisionPrim = 'OrdnanceCollisionPrim'
       OrdnanceEffect = 'OrdnanceEffect'
       OrdnanceGeometryName = 'OrdnanceGeometryName'
       OrdnanceName = 'OrdnanceName'
       OrdnanceSound = 'OrdnanceSound'
       OverheatSound = 'OverheatSound'
       OverheatSoundPitch = 'OverheatSoundPitch'
       OverheatStopSound = 'OverheatStopSound'
       OverrideTexture = 'OverrideTexture'
       OverrideTexture2 = 'OverrideTexture2'
       PCaxPitchSpeed = 'PCaxPitchSpeed'
       PCMaxPitchSpeed = 'PCMaxPitchSpeed'
       PCMaxStrafeSpeed = 'PCMaxStrafeSpeed'
       PCMaxTurnSpeed = 'PCMaxTurnSpeed'
       PCMaxYawSpeed = 'PCMaxYawSpeed'
       PCPitchRate = 'PCPitchRate'
       PCPitchSpeed = 'PCPitchSpeed'
       PCPitchTurnFactor = 'PCPitchTurnFactor'
       PCSpinRate = 'PCSpinRate'
       PCTurnRate = 'PCTurnRate'
       PCTurnSpeed = 'PCTurnSpeed'
       PCYawTurnFactor = 'PCYawTurnFactor'
       PersonHealth = 'PersonHealth'
       PersonScale = 'PersonScale'
       Pilot9Pose = 'Pilot9Pose'
       PilotAnimation = 'PilotAnimation'
       PilotPosition = 'PilotPosition'
       PilotSkillRepairScale = 'PilotSkillRepairScale'
       PilotType = 'PilotType'
       PitchDown = 'pitch_down'
       PitchUp = 'pitch_up'
       Pitch = 'pitch'
       PitchDamp = 'PitchDamp'
       PitchFilter = 'PitchFilter'
       PitchLimits = 'PitchLimits'
       PitchRate = 'PitchRate'
       PitchSpread = 'PitchSpread'
       PitchTurnFactor = 'PitchTurnFactor'
       PowerupDelay = 'PowerupDelay'
       Powerupsound = 'Powerupsound'
       PPitchRate = 'PPitchRate'
       PreparingForDamageSound = 'PreparingForDamageSound'
       PrimaryWeapon = 'PrimaryWeapon'
       ProneMoveSpread = 'ProneMoveSpread'
       ProneSound = 'ProneSound'
       ProneStillSpread = 'ProneStillSpread'
       Push = 'Push'
       PushDeduction = 'PushDeduction'
       PushRadius = 'PushRadius'
       PushRadiusInner = 'PushRadiusInner'
       PushRadiusOuter = 'PushRadiusOuter'
       Radius = 'Radius'
       RadiusFadeMax = 'RadiusFadeMax'
       RadiusFadeMin = 'RadiusFadeMin'
       Range = 'Range'
       RayRadius = 'RayRadius'
       RayTriggerMinSpeed = 'RayTriggerMinSpeed'
       RayTriggerWidth = 'RayTriggerWidth'
       Rebound = 'Rebound'
       RecoilDecayHeavy = 'RecoilDecayHeavy'
       RecoilDecayLight = 'RecoilDecayLight'
       RecoilDelayHeavy = 'RecoilDelayHeavy'
       RecoilDelayLight = 'RecoilDelayLight'
       RecoilLengthHeavy = 'RecoilLengthHeavy'
       RecoilLengthLight = 'RecoilLengthLight'
       RecoilStrengthHeavy = 'RecoilStrengthHeavy'
       RecoilStrengthLight = 'RecoilStrengthLight'
       RefillFromItem = 'RefillFromItem'
       ReloadSound = 'ReloadSound'
       ReloadTime = 'ReloadTime'
       RepMusic = 'RepMusic'
       ReserveOneForPlayer = 'ReserveOneForPlayer'
       ResetTeam = 'ResetTeam'
       RespawnTime = 'RespawnTime'
       RestDir = 'RestDir'
       ReticuleTexture = 'ReticuleTexture'
       ReverseSpeed = 'ReverseSpeed'
       RightFootstepSound = 'RightFootstepSound'
       RollSound = 'RollSound'
       Rotation = 'Rotation'
       RotationRate = 'RotationRate'
       RotationVelocity = 'RotationVelocity'
       RoundDelay = 'RoundDelay'
       RoundsPerClip = 'RoundsPerClip'
       RoundsPersalvo = 'RoundsPersalvo'
       RoundsPerSalvo = 'RoundsPerSalvo'
       SalvoCount = 'SalvoCount'
       SalvoDelay = 'SalvoDelay'
       SalvoTime = 'SalvoTime'
       ScanningRange = 'ScanningRange'
       ScatterDistance = 'ScatterDistance'
       SCDriverGetInSound = 'SCDriverGetInSound'
       SCDriverGetOutSound = 'SCDriverGetOutSound'
       SCFieldFollowSound = 'SCFieldFollowSound'
       SCFieldHoldSound = 'SCFieldHoldSound'
       SCFieldMoveOutSound = 'SCFieldMoveOutSound'
       SCGunnerAllClearSound = 'SCGunnerAllClearSound'
       SCGunnerGetInSound = 'SCGunnerGetInSound'
       SCGunnerGetOutSound = 'SCGunnerGetOutSound'
       SCGunnerSteadySound = 'SCGunnerSteadySound'
       ScopeTexture = 'ScopeTexture'
       SCPassengerGetInSound = 'SCPassengerGetInSound'
       SCPassengerGetOutSound = 'SCPassengerGetOutSound'
       SCPassengerMoveOutSound = 'SCPassengerMoveOutSound'
       SCPassengerStopSound = 'SCPassengerStopSound'
       SCResponseNosirSound = 'SCResponseNosirSound'
       SCResponseYessirSound = 'SCResponseYessirSound'
       SecondaryWeapon = 'SecondaryWeapon'
       Seed = 'Seed'
       SelfDestructSoundPitch = 'SelfDestructSoundPitch'
       SetAltitude = 'SetAltitude'
       Shake = 'Shake'
       ShakeLength = 'ShakeLength'
       ShakeRadius = 'ShakeRadius'
       ShakeRadiusInner = 'ShakeRadiusInner'
       ShakeRadiusOuter = 'ShakeRadiusOuter'
       ShieldEffect = 'ShieldEffect'
       ShieldOffset = 'ShieldOffset'
       ShieldOffSound = 'ShieldOffSound'
       ShieldRadius = 'ShieldRadius'
       ShieldScale = 'ShieldScale'
       ShieldSound = 'ShieldSound'
       ShockFadeInTime = 'ShockFadeInTime'
       ShockFadeOutGain = 'ShockFadeOutGain'
       ShockFadeOutTime = 'ShockFadeOutTime'
       ShockSound = 'ShockSound'
       Shotdelay_ = 'shotdelay' # TODO
       ShotDelay = 'ShotDelay'
       ShotElevate = 'ShotElevate'
       ShotPatternCount = 'ShotPatternCount'
       ShotPatternPitchYaw = 'ShotPatternPitchYaw'
       ShotsPerSalvo = 'ShotsPerSalvo'
       SkeletonLowRes = 'SkeletonLowRes'
       SkeletonLowResRootScale = 'SkeletonLowResRootScale'
       SkeletonName = 'SkeletonName'
       SkeletonRootScale = 'SkeletonRootScale'
       SkeletonRootScaleLowRes = 'SkeletonRootScaleLowRes'
       SkinnyFactor = 'SkinnyFactor'
       SmallBan = 'SmallBan'
       SmashParkedFlyers = 'SmashParkedFlyers'
       SniperScope = 'SniperScope'
       SoldierAmmo = 'SoldierAmmo'
       SoldierAnimation = 'SoldierAnimation'
       SoldierBan = 'SoldierBan'
       SoldierCollision_ = 'soldierCollision' # TODO
       Soldiercollision = 'Soldiercollision'
       SoldierCollision = 'SoldierCollision'
       SoldierCollisionOnly = 'SoldierCollisionOnly'
       SoldierCollisionPrim = 'SoldierCollisionPrim'
       SoldierHealth = 'SoldierHealth'
       Sound = 'Sound'
       SoundName = 'SoundName'
       SoundPitchDev = 'SoundPitchDev'
       SoundProperty = 'SoundProperty'
       SpawnPath = 'SpawnPath'
       SpawnPointCount = 'SpawnPointCount'
       SpawnPointLocation = 'SpawnPointLocation'
       SpawnSound = 'SpawnSound'
       SpawnTime = 'SpawnTime'
       SpinRate = 'SpinRate'
       SpreadLimit = 'SpreadLimit'
       SpreadPerShot = 'SpreadPerShot'
       SpreadRadius = 'SpreadRadius'
       SpreadRecover = 'SpreadRecover'
       SpreadRecoverRate = 'SpreadRecoverRate'
       SpreadThreshold = 'SpreadThreshold'
       SquatSound = 'SquatSound'
       StandMoveSpread = 'StandMoveSpread'
       StandSound = 'StandSound'
       StandStillSpread = 'StandStillSpread'
       Static_ = 'static' # TODO
       Static = 'Static'
       StatusTexture = 'StatusTexture'
       SteerLeft = 'steer_left'
       SteerRight = 'steer_right'
       Steer = 'steer'
       StickAnimal = 'StickAnimal'
       StickBuilding = 'StickBuilding'
       StickBuildingDead = 'StickBuildingDead'
       StickBuildingUnbuilt = 'StickBuildingUnbuilt'
       StickDroid = 'StickDroid'
       StickPerson = 'StickPerson'
       StickTerrain = 'StickTerrain'
       StickVehicle = 'StickVehicle'
       StompDecal = 'StompDecal'
       StompDecalSize = 'StompDecalSize'
       StompDetectionType = 'StompDetectionType'
       StompEffect = 'StompEffect'
       StompThreshold = 'StompThreshold'
       StoppedTurnSpeed = 'StoppedTurnSpeed'
       StrafeLeft = 'strafe_left'
       StrafeRight = 'strafe_right'
       Strafe = 'strafe'
       StrafeRollAngle = 'StrafeRollAngle'
       StrafeSpeed = 'StrafeSpeed'
       Strategic_Filter1 = 'Strategic_Filter1'
       Strategic_Filter2 = 'Strategic_Filter2'
       Strategic_Filter3 = 'Strategic_Filter3'
       Strategic_Filter4 = 'Strategic_Filter4'
       Strategic_Filter5 = 'Strategic_Filter5'
       Strategic_Filter6 = 'Strategic_Filter6'
       StrikeOrdnanceName = 'StrikeOrdnanceName'
       SuppressRadius = 'SuppressRadius'
       SuspensionLeftArmNodeName = 'SuspensionLeftArmNodeName'
       SuspensionMaxOffset = 'SuspensionMaxOffset'
       SuspensionMidOffset = 'SuspensionMidOffset'
       SuspensionNodeName = 'SuspensionNodeName'
       SuspensionRightArmNodeName = 'SuspensionRightArmNodeName'
       SwingSpeed = 'SwingSpeed'
       SwingTime = 'SwingTime'
       SwitchImmediately = 'SwitchImmediately'
       TakeoffHeight = 'TakeoffHeight'
       TakeoffSound = 'TakeoffSound'
       TakeoffSpeed = 'TakeoffSpeed'
       TakeoffTime = 'TakeoffTime'
       TargetableCollision = 'TargetableCollision'
       TargetAnimal = 'TargetAnimal'
       TargetBuilding = 'TargetBuilding'
       TargetDroid = 'TargetDroid'
       TargetEnemy = 'TargetEnemy'
       TargetFriendly = 'TargetFriendly'
       TargetNeutral = 'TargetNeutral'
       TargetPerson = 'TargetPerson'
       TargetVehicle = 'TargetVehicle'
       TempAnimationSpeed = 'TEMP_AnimationSpeed'
       TempType = 'TEMP_Type'
       TerrainCollision = 'TerrainCollision'
       TerrainCollisionPrim = 'TerrainCollisionPrim'
       TerrainLeft = 'TerrainLeft'
       TerrainRight = 'TerrainRight'
       Texture = 'Texture'
       ThirdPersonFOV = 'ThirdPersonFOV'
       ThrottleDown = 'throttle_down'
       ThrottleUp = 'throttle_up'
       Throttle = 'throttle'
       ThrustAttachOffset = 'ThrustAttachOffset'
       ThrustAttachPoint = 'ThrustAttachPoint'
       ThrustEffect = 'ThrustEffect'
       ThrustEffectMaxScale = 'ThrustEffectMaxScale'
       ThrustEffectMinScale = 'ThrustEffectMinScale'
       ThrustEffectScaleStart = 'ThrustEffectScaleStart'
       ThrustPitchAngle = 'ThrustPitchAngle'
       TickSound = 'TickSound'
       TickSoundPitch = 'TickSoundPitch'
       TiltValue = 'TiltValue'
       TowCableCollision = 'TowCableCollision'
       TrackPitchMinus = 'track_pitch_minus'
       TrackPitchPlus = 'track_pitch_plus'
       TrackPitchReset = 'track_pitch_reset'
       TrackYawMinus = 'track_yaw_minus'
       TrackYawPlus = 'track_yaw_plus'
       TrackYawReset = 'track_yaw_reset'
       TrackCenter = 'TrackCenter'
       TrackDeathOnAttach = 'TrackDeathOnAttach'
       TrackingSound = 'TrackingSound'
       TrackOffset = 'TrackOffset'
       Traction = 'Traction'
       TrailEffect = 'TrailEffect'
       TrakCenter = 'TrakCenter'
       TransmitRange = 'TransmitRange'
       TransparentType = 'TransparentType'
       TrialEffect = 'TrialEffect'
       TriggerAll = 'TriggerAll'
       TriggerAnimation = 'TriggerAnimation'
       TriggerCollision = 'TriggerCollision'
       TriggerContact = 'TriggerContact'
       TriggerOffset = 'TriggerOffset'
       TriggerRadius = 'TriggerRadius'
       TriggerSingle = 'TriggerSingle'
       TriggerTeam = 'TriggerTeam'
       TurnFilter = 'TurnFilter'
       TurningOffSound = 'TurningOffSound'
       TurnOffSound = 'TurnOffSound'
       TurnOffTime = 'TurnOffTime'
       TurnOnSound = 'TurnOnSound'
       TurnOnTime = 'TurnOnTime'
       TurnRate = 'TurnRate'
       TurnThreshold = 'TurnThreshold'
       TurretActivateSound = 'TurretActivateSound'
       TurretAmbientSound = 'TurretAmbientSound'
       TurretDeactivateSound = 'TurretDeactivateSound'
       TurretMoveSound = 'TurretMoveSound'
       TurretMoveSoundStartEndPitch = 'TurretMoveSoundStartEndPitch'
       TurretMoveSoundStartEndTime = 'TurretMoveSoundStartEndTime'
       TurretNodeName = 'TurretNodeName'
       TurretPitchSound = 'TurretPitchSound'
       TurretPitchSoundPitch = 'TurretPitchSoundPitch'
       TurretSection = 'TURRETSECTION'
       TurretStartSound = 'TurretStartSound'
       TurretStopSound = 'TurretStopSound'
       TurretYawSound = 'TurretYawSound'
       TurretYawSoundPitch = 'TurretYawSoundPitch'
       UnbuiltGeometryName = 'UnbuiltGeometryName'
       UnbuiltHoloOdf = 'UnbuiltHoloOdf'
       UnitName = 'unitName'
       UnitType = 'UnitType'
       UprightLowResModel = 'UprightLowResModel'
       UprightWaterDamageHeight = 'UprightWaterDamageHeight'
       UseVCollForFlyers = 'UseVCollForFlyers'
       Value_ATK_Alliance = 'Value_ATK_Alliance'
       Value_ATK_CIS = 'Value_ATK_CIS'
       Value_ATK_Empire = 'Value_ATK_Empire'
       Value_ATK_Locals = 'Value_ATK_Locals'
       Value_ATK_Republic = 'Value_ATK_Republic'
       Value_DEF_Alliance = 'Value_DEF_Alliance'
       Value_DEF_CIS = 'Value_DEF_CIS'
       Value_DEF_Empire = 'Value_DEF_Empire'
       Value_DEF_Locals = 'Value_DEF_Locals'
       Value_DEF_Republic = 'Value_DEF_Republic'
       ValueBleed = 'ValueBleed'
       VehicleAmmo = 'VehicleAmmo'
       VehicleCollision = 'vehiclecollision'
       VehicleCollision = 'Vehiclecollision'
       VehicleCollision = 'VehicleCollision'
       VehicleCollisionOnly = 'vehiclecollisiononly'
       VehicleCollisionOnly = 'VehicleCollisiononly'
       VehicleCollisionOnly = 'VehicleCollisionOnly'
       VehicleCollisionPrim = 'VehicleCollisionPrim'
       VehicleCollisionSound = 'VehicleCollisionSound'
       VehicleHealth = 'VehicleHealth'
       VehiclePosition = 'VehiclePosition'
       VehicleScale = 'VehicleScale'
       VehicleType = 'VehicleType'
       Velocity = 'Velocity'
       VelocityDamp = 'VelocityDamp'
       VelocitySpring = 'VelocitySpring'
       VerticalSpread = 'VerticalSpread'
       Vine = 'Vine'
       Virtual = 'Virtual'
       VO_All_AllCapture = 'VO_All_AllCapture'
       VO_All_AllInDispute = 'VO_All_AllInDispute'
       VO_All_AllInfo = 'VO_All_AllInfo'
       VO_All_AllLost = 'VO_All_AllLost'
       VO_All_AllSaved = 'VO_All_AllSaved'
       VO_All_ImpCapture = 'VO_All_ImpCapture'
       VO_All_ImpInDispute = 'VO_All_ImpInDispute'
       VO_All_ImpInfo = 'VO_All_ImpInfo'
       VO_All_ImpLost = 'VO_All_ImpLost'
       VO_All_ImpSaved = 'VO_All_ImpSaved'
       VO_CIS_CISCapture = 'VO_CIS_CISCapture'
       VO_CIS_CISInDispute = 'VO_CIS_CISInDispute'
       VO_CIS_CISInfo = 'VO_CIS_CISInfo'
       VO_CIS_CISLost = 'VO_CIS_CISLost'
       VO_CIS_CISSaved = 'VO_CIS_CISSaved'
       VO_CIS_RepCapture = 'VO_CIS_RepCapture'
       VO_CIS_RepInDispute = 'VO_CIS_RepInDispute'
       VO_CIS_RepInfo = 'VO_CIS_RepInfo'
       VO_CIS_RepLost = 'VO_CIS_RepLost'
       VO_CIS_RepSaved = 'VO_CIS_RepSaved'
       VO_Imp_AllCapture = 'VO_Imp_AllCapture'
       VO_Imp_AllInDispute = 'VO_Imp_AllInDispute'
       VO_Imp_AllInfo = 'VO_Imp_AllInfo'
       VO_Imp_AllLost = 'VO_Imp_AllLost'
       VO_Imp_AllSaved = 'VO_Imp_AllSaved'
       VO_Imp_ImpCapture = 'VO_Imp_ImpCapture'
       VO_Imp_ImpInDispute = 'VO_Imp_ImpInDispute'
       VO_Imp_ImpInfo = 'VO_Imp_ImpInfo'
       VO_Imp_ImpLost = 'VO_Imp_ImpLost'
       VO_Imp_ImpSaved = 'VO_Imp_ImpSaved'
       VO_Rep_CISCapture = 'VO_Rep_CISCapture'
       VO_Rep_CISInDispute = 'VO_Rep_CISInDispute'
       VO_Rep_CISInfo = 'VO_Rep_CISInfo'
       VO_Rep_CISLost = 'VO_Rep_CISLost'
       VO_Rep_CISSaved = 'VO_Rep_CISSaved'
       VO_Rep_RepCapture = 'VO_Rep_RepCapture'
       VO_Rep_RepInDispute = 'VO_Rep_RepInDispute'
       VO_Rep_RepInfo = 'VO_Rep_RepInfo'
       Vo_Rep_RepLost = 'VO_Rep_RepLost'
       Vo_Rep_RepSaved = 'VO_Rep_RepSaved'
       WakeEffect = 'WakeEffect'
       WakeWaterSplashEffect = 'WakeWaterSplashEffect'
       WalkerLegPair = 'WalkerLegPair'
       WalkerOrientRoll = 'WalkerOrientRoll'
       WalkerSection = 'WALKERSECTION'
       WalkerWidth = 'WalkerWidth'
       WaterDamageAmount = 'WaterDamageAmount'
       WaterDamageInterval = 'WaterDamageInterval'
       WaterEffect = 'WaterEffect'
       WaterSplashEffect = 'WaterSplashEffect'
       WaterWadingSound = 'WaterWadingSound'
       WaverRate = 'WaverRate'
       WaverTurn = 'WaverTurn'
       WeaponFire = 'weapon_fire'
       WeaponNext = 'weapon_next'
       WeaponPrev = 'weapon_prev'
       WeaponSpecial = 'weapon_special'
       WeaponAmmo = 'WeaponAmmo'
       WeaponAmmo1 = 'WeaponAmmo1'
       WeaponAmmo2 = 'WeaponAmmo2'
       WeaponAmmo3 = 'WeaponAmmo3'
       WeaponAmmo4 = 'WeaponAmmo4'
       WeaponChange = 'WeaponChange'
       WeaponChangeSound = 'WeaponChangeSound'
       WeaponChannel = 'WeaponChannel'
       WeaponChannel1 = 'WeaponChannel1'
       WeaponChannel2 = 'WeaponChannel2'
       WeaponChannel3 = 'WeaponChannel3'
       WeaponChannel4 = 'WeaponChannel4'
       WeaponClass = 'WeaponClass'
       WeaponName = 'WeaponName'
       WeaponName1 = 'WeaponName1'
       WeaponName2 = 'WeaponName2'
       WeaponName3 = 'WeaponName3'
       WeaponName4 = 'WeaponName4'
       WeaponSection = 'WeaponSection'
       WeaponSection = 'WEAPONSECTION'
       WiggleAmount = 'WiggleAmount'
       WiggleSpeed = 'WiggleSpeed'
       WindSound = 'WindSound'
       WingModel = 'WingModel'
       YawLimits = 'YawLimits'
       YawSpread = 'YawSpread'
       YawTurnFactor = 'YawTurnFactor'
       YOffset = 'YOffset'
       ZoomFactorMinus = 'zoom_factor_minus'
       ZoomFactorPlus = 'zoom_factor_plus'
       ZoomFactorReset = 'zoom_factor_reset'
       ZoomFirstPerson = 'ZoomFirstPerson'
       ZoomMax = 'ZoomMax'
       ZoomMin = 'ZoomMin'
       ZoomRate = 'ZoomRate'

    def __init__(self, registry: FileRegistry, filepath: Path, tokens: list[Token] = None, logger = logger):
        Format.__init__(self, registry=registry, filepath=filepath, tokens=tokens, logger=logger)

        self.curr = self

    def parse_format(self):
        while self:
            if self.get().type in TK.Whitespaces:
                self.discard()  # Discard whitespaces at the start of a line

            # Comment
            elif self.get().type in [TK.Slash, TK.Backslash]:
                self.consume_until(TK.LineFeed)

                comment = Comment(self.collect_tokens())
                self.curr.add(comment)

                self.discard()  # \n

            # Section
            elif self.get().type == TK.SquareBracketOpen:
                self.discard()  # [

                self.consume_until(TK.SquareBracketClose)

                if self.curr != self:
                    self.curr = self.curr.parent

                section = Section(self.collect_tokens())
                self.curr = section
                self.add(section)

                self.discard()  # ]

            # Key value pair
            elif self.get().type == TK.Word:
                while self.consume(TK.Word):
                    pass

                key = Key(self.collect_tokens())
                self.curr.add(key)

                while self.consume_any([TK.EqualSign] + TK.Whitespaces):
                    pass

                self.collect_tokens()  # Discard whitespaces and '=' between key and value

                self.consume_until(TK.LineFeed)

                value_tokens = self.collect_tokens()
                value_text = ''.join(list(map(lambda x: x.text, value_tokens)))

                if re.match(Reference.RE_FILE, value_text) is not None:
                    reference = Reference(value_tokens)
                    key.add(reference)
                else:
                    value = Value(value_tokens)
                    key.add(value)

                self.discard()  # \n

            # Either skip or throw error
            else:
                logger.warning(f'Unrecognized token "{self.get()} ({self.tokens()})".')
                self.discard()
                # self.error(TK.Null)

        return self


if __name__ == '__main__':
    Odf.cmd_helper()
